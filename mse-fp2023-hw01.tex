%! suppress = Makeatletter
%! suppress = TooLargeSection
%! suppress = MissingLabel
\documentclass{article}

% Fields
\usepackage{geometry}
\geometry{top=25mm}
\geometry{bottom=35mm}
\geometry{left=20mm}
\geometry{right=20mm}
% ------------------------------------------------

% Graphics
\usepackage{color}
\usepackage{tabularx}
\usepackage{tikz}
\usepackage{blkarray}
\usepackage{graphicx}
% ------------------------------------------------

% Math
\usepackage{amsmath, amsfonts}
\usepackage{amssymb}
\usepackage{proof}
\usepackage{mathrsfs}
% Crossed-out symbols
% https://tex.stackexchange.com/questions/75525/how-to-write-crossed-out-math-in-latex
\usepackage[makeroom]{cancel}
\usepackage{mathtools}
% ------------------------------------------------

% Additional font sizes
% https://www.overleaf.com/learn/latex/Questions/How_do_I_adjust_the_font_size%3F
\usepackage{moresize}
% Additional colors
% https://www.overleaf.com/learn/latex/Using_colours_in_LaTeX
\usepackage{xcolor}
% \texttimes
\usepackage{textcomp}
% ------------------------------------------------

% Language
\usepackage[utf8] {inputenc}
\usepackage[T2A] {fontenc}
\usepackage[english, russian] {babel}
\usepackage{indentfirst, verbatim}
\usetikzlibrary{cd, babel}
% ------------------------------------------------

% Fonts
\usepackage{stmaryrd}
\usepackage{cmbright}
\usepackage{wasysym}
% ------------------------------------------------

% Code
% https://tex.stackexchange.com/questions/99475/how-to-invoke-latex-with-the-shell-escape-flag-in-texstudio-former-texmakerx
% Colored, requires --shell-escape compiling option
% \usepackage{minted}
% \setminted{xleftmargin=\parindent, autogobble, escapeinside=\#\#}
\usepackage{listings}
% ------------------------------------------------

% Custom envs
% https://tex.stackexchange.com/questions/371286/draw-a-horizontal-line-in-latex
\newenvironment{proof}{\subparagraph{\hspace{-1em}Решение:\newline}}{\par\noindent\rule{\textwidth}{0.4pt}}
% ------------------------------------------------

% Custom commands
\newcommand{\comb}[1]{\mathbf{#1}}
\newcommand{\step}{\rightsquigarrow}
\newcommand{\term}[1]{\mathbf{#1}}
\newcommand{\ap}{~}
\newcommand{\termdef}{\coloneqq}
\newcommand{\subst}[3]{\left[#2 \mapsto #3 \right] #1}
\newcommand{\eqbeta}{=_\beta}
\newcommand{\eqeta}{=_\eta}
% ------------------------------------------------

% Head
\usepackage{fancybox,fancyhdr}
\usepackage{hyperref}
\pagestyle{fancy}
\fancyhead[R]{Студент(ка) Студентов(а)} % TODO введите ваше имя
\fancyhead[L]{ИТМО MSE, ФП 2023, Дз 1}
% ------------------------------------------------

% Numbering
% https://tex.stackexchange.com/questions/80113/hide-section-numbers-but-keep-numbering
\makeatletter
\renewcommand\thesubsection{Блок \@arabic\c@subsection.\hspace{-0.8em}}
\renewcommand\thesubsubsection{Задание \@arabic\c@subsection.\@arabic\c@subsubsection\hspace{-0.8em}}
% https://tex.stackexchange.com/questions/327689/numbering-subsubsections-with-letters
\renewcommand\theparagraph{\alph{paragraph})\hspace{-0.8em}}
% https://tex.stackexchange.com/questions/129208/numbering-paragraphs-in-latex
\setcounter{secnumdepth}{4}
\makeatother
% ------------------------------------------------

\begin{document}
    \section*{Введение}

    \subsection*{Система оценивания и общие советы}

    Оценка за курс ставится по результатам экзамена, где будет учитываться также и успеваемость по практике.
    Чтобы получить допуск на экзамен, нужно получить зачёт по практике, который ставится, если зачтены все домашние задания, кроме, может быть, одного.

    Каждое домашнее задание разделено на блоки по разновидностям задач.
    Чтобы зачесть задание нужно либо набрать локальный минимум по каждому блоку, либо набрать глобальный минимум по сумме всех блоков.
    Таким образом, если у вас какой-то блок совсем не получается и вы не можете набрать по нему локальный минимум, вы можете решить побольше в других блоках и зачесть задание, достигнув глобального минимума по общей сумме баллов решенных задач.
    Если обоими способами не получается набрать нужное количество~--- ничего страшного, потом будет достаточно возможностей добрать баллов.
    Постарайтесь тратить как можно меньше сил на тревогу и переживания.

    Ваша задача в каждом дз --- постараться как можно глубже погрузиться в как можно большее количество заданий.
    Так вы либо хорошо разберетесь сами, либо дадите себе все шансы понять разбор заданий на следующей паре так, чтобы после него уже не оставалось белых пятен.
    За неполные решения тоже ставятся баллы~--- не стесняйтесь браться и пробовать.
    Пересматривайте материалы с практик и лекций~--- там должно быть всё необходимое.
    Старайтесь как можно раньше браться за домашки, пока свежи воспоминания с практики и достаточно времени на осознание.
    Если уже хорошо знакомы с темой, не тратьте время на вводные задачки в начале блоков, начинайте с середины (но проверить базовые знания тоже может быть хорошей идеей).

    Совет: как только набираете нужное количество баллов, переключайтесь на задания по другим курсам.
    Если есть желание, решать больше можно и приветствуется --- будет бонусом.
    Но ни в коем случае не в ущерб сну и не во вред себе.

    \subsection*{Помощь}

    Не стесняйтесь обращаться за помощью к вашим преподавателям, они тут как раз для этого.
    Все контакты вы найдёте на вики.
    Нам не сложно и в радость вам помогать, а наблюдать молчаливое непонимание как раз грустно.
    Не обесценивайте свои трудности, ищите поддержки --- и найдёте.

    Также просите помощи у своих одногруппников, помогать интересно и полезно.

    Если вы помогаете, не навредите!
    Предлагайте объяснения, а не ответы.
    Отталкивайтесь от потребностей собеседника, а не от желания показать себя.
    Человеку и так может быть не очень здорово, очень просто закопать его ещё глубже, говоря избыток умных слов и демонстрируя свою эрудицию.

    Помните: у всех разная подготовка и способности к построению определённых видов умозрительных конструкций, с этим особо ничего не сделаешь.
    Но это никак вас не определяет.
    Чем сложнее даётся, тем ценнее любой шажок.
    Не будьте слишком требовательны к себе и двигайтесь в своём темпе.
    Всё будет хорошо, гарантируем.

    Не всем просто психологически обращаться за помощью.
    Но это важно, без этого никак.
    Попробуйте относиться к этому как к части работы и постарайтесь, оно окупится.

    \subsection*{Порядок сдачи домашних заданий по лямбда-исчислению}

    \begin{itemize}
        \item Задания выполняются в исходнике данного документа (если вы не знакомы с \LaTeX~--- для вас следующий раздел).
        Укажите в его шапке своё имя.
        \item Оформление решений:
        \begin{itemize}
            \item Оформляйте формулы разборчиво.
            Соблюдайте стиль из слайдов: синтаксис термов, комбинаторы большими жирными буквами, названия термов маленькими жирными буквами, мета-переменные большими буквами, переменные маленькими.
            \item Нумеруйте переходы, чтобы можно было удобнее ссылаться в рецензии.
            \item Приводите решение достаточно полно, чтобы его можно было быстро проверить, а не догадываться, как вы сделали тот или иной переход.
            Сильно много писать тоже не надо, соблюдайте баланс.
            Попробуйте поставить себя на место преподавателя и подумать, что нужно увидеть, чтобы понять: решено верно, студент разобрался.
            \item Код на лямбда-исчислении, как и на любом другом языке программирования, нужно тестировать!
            Старайтесь тестировать свои решения на простых примерах.
            \item Также вводите вспомогательные определения для достижения читаемости.
        \end{itemize}
        \item Pdf присылается на почту вашего преподавателя в письме с темой вида: \textit{Дз N, Фамилия Имя}.
        \item Старайтесь прислать первую версию к мягкому дедлайну --- до полуночи за двое суток до следующей практики.
        Так у преподавателя будет время прислать рецензию, а у вас --- исправить до жесткого дедлайна.
        \item Исправления посылаются по почте как ответ на рецензию.
        Указывайте в документе или письме, какие пункты вы изменили.
        \item Жесткий дедлайн --- полночь перед практикой.
    \end{itemize}

    Указание: если решение получается громоздким и вы в нём путаетесь, значит вы что-то делаете не лучшим образом.
    Поработайте над своей методологией и, возможно, следует обратиться за подсказкой.
    Если не уверены в ходе мыслей, хорошей идеей может быть обратиться с просьбой их провалидировать.

    \subsection*{\LaTeX}

    Вам не нужно изучать \LaTeX чтобы качественно выполнить все задания.
    Достаточно просто делать по образцу того, как оформлены сами задачи.
    Однако следующие материалы могут оказаться полезными:

    \begin{itemize}
        \item \href{https://www.overleaf.com/learn}{Overleaf} --- туториалы по \LaTeX и онлайн редактор.
        \item \href{https://youtu.be/NOslSvJs29I}{LaTeX: краткое введение в качественную типографику}.
    \end{itemize}

    Репозиторий с исходниками можно скачать с \href{https://github.com/mse-fp2023/calculus-hws}{github}.

    Для работы существуют следующие варианты:
    \begin{itemize}
        \item Локальная установка \LaTeX дистрибутива и ваш любимый текстовый редактор с плагином для \LaTeX.
        \item Онлайн редактор, например, \url{https://www.overleaf.com/}.
    \end{itemize}

    Сборка:
    \begin{itemize}
        \item Если вы пользуетесь IntelliJ IDEA, конфигурация сборки добавлена в репозиторий.
        Выбираете нужную и жмакаете зелёную стрелку.
        \item Можете воспользоваться утилитой Make: вызовите \texttt{make} в корневой директории репозитория.
        \item В случае TexStudio и overleaf они собирают сами, но работать так менее удобно.
    \end{itemize}

    \begin{flushright}
        P.s.\ Добро пожаловать на курс!
        Успехов! \\
        Всецело ваша, команда курса
    \end{flushright}

    \newpage


    \section*{Дз 1. Лямбда-исчисление}

    Глобальный минимум: 8б.

    \subsection{Синтаксис и семантика лямбда-исчисления}

    Локальный минимум: 4б.

    \subsubsection{(1б)}

    Уберите все лишние скобки из выражения:
    \[((\lambda x\ldotp ((\lambda z\ldotp (z~(z~z)))~(y~(\lambda z\ldotp ((n~((m~p)~o)))))))~(\lambda x\ldotp (x)))\]

    Подсказка: можно воспользоваться представлением терма как дерева.

    \begin{proof}
        TODO % TODO
    \end{proof}

    \subsubsection{(1б)}

    Найдите все свободные переменные, а также обозначьте, к какому связывателю относится каждая связанная (это удобнее всего сделать с помощью индексов):
    \[(\lambda x\ldotp y~y~(\lambda y\ldotp x~((\lambda z\ldotp z~y~x)~(\lambda x\ldotp z~x))))\]

    \begin{proof}
        TODO % TODO
    \end{proof}

    \subsubsection{}

    \paragraph{(1б)}

    Покажите, что $\comb{B} \eqbeta \comb{S}~(\comb{K}~\comb{S})~\comb{K}$, расписывая и нумеруя промежуточные шаги.

    Подсказка: не спешите сразу раскрывать все определения.

    \begin{proof}
        TODO % TODO
    \end{proof}

    \paragraph{(1б)}

    Покажите, что $\comb{K}^* \eqbeta \comb{K}~\comb{I}$.

    \begin{proof}
        TODO % TODO
    \end{proof}

    \subsubsection{}

    Осуществите подстановку и приведите к нормальной форме~--- форме, в которой не осталось редексов, указывая при этом основные шаги.

    \paragraph{(1б)}

    $x \termdef \comb{K}$ и $y \termdef \comb{B}$ в $y~(\comb{K}~(\lambda z\ldotp x~x~(x~z~x))~y)~(\lambda x\ldotp x~x~x)~\comb{I}$.

    \begin{proof}
        TODO % TODO
    \end{proof}

    \paragraph{(1б)}

    $x \termdef \comb{S}$ в $x~(\lambda z~x\ldotp z~x)~(\lambda z~y~x\ldotp x)~x$.

    \begin{proof}
        TODO % TODO
    \end{proof}

    \subsection{Программирование в лямбда-исчислении}

    Локальный минимум: 3б.

    \subsubsection{(1б)}

    Задайте лямбда-терм $\textbf{or}~b_1~b_2$, который вычисляет дизъюнкцию двух логических величин.

    \begin{proof}
        TODO % TODO
    \end{proof}

    \subsubsection{(1б)}

    Задайте лямбда-терм $\term{mult}~a~b$, перемножающий два числа Чёрча, и лямбда-терм $\term{pow}~a~b$, который вычисляет $a^b$.

    \begin{proof}
        TODO % TODO
    \end{proof}

    \subsubsection{(1б)}

    Задайте лямбда-терм $\term{isZero}$, который возвращает $\term{true}$, если подать $\term{0}$, и $\term{false}$ в противном случае.

    \begin{proof}
        TODO % TODO
    \end{proof}

    \subsubsection{(1б)}

    Скорее всего, ваш любимый язык программирования имеет поддержку функций высших порядков.
    Закодируйте на нём пары в стиле чистого лямбда-исчисления (не забывайте про каррирование).

    Как известно, котики полностью описываются двумя параметрами: именем и мурлычностью.
    Реализуйте библиотеку функций для работы с котиками, используя реализованные лямбда-пары как низкоуровневый примитив.
    Нужно написать функции: для создания котика, просмотра имени и мурлычности по котику.
    А так же реализовать функцию ``почесать'', которая по котику будет возвращать котика повышенной мурлычности.

    Если у вас статически типизированный язык программирования:
    \begin{itemize}
        \item Вам полагается дополнительный балл в случае успеха.
        \item Достаточно поддержать только хранение интов.
        \item Максимально используйте возможности вывода типов в вашем языке: \texttt{auto} в C++, \texttt{var} в Java\ldots
        \item Используйте только лямбды, они, как правило, имеют больше возможностей по выводу типов.
    \end{itemize}

    \begin{proof}
        TODO % TODO
    \end{proof}

    \subsubsection{(1б)}

    Задайте лямбда-терм $\term{divides3}~n$, который возвращает $\term{true}$, если $n$ делится на 3 без остатка, и $\term{false}$ в противном случае.

    \begin{proof}
        TODO % TODO
    \end{proof}

    \subsubsection{(2б)}

    Задайте лямбда-терм $\term{pred}~n$, который находит предыдущее число Чёрча.

    Подсказка:
    \begin{lstlisting}[language=Python]
    def pred(n):
      prd = 0
      cur = 0
      for i in range(0, n):
        prd = cur
        cur = cur + 1
      return prd
    \end{lstlisting}

    \begin{proof}
        TODO % TODO
    \end{proof}

\end{document}
